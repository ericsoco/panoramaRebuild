{"version":3,"sources":["../es6/index.jsx"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import React, { PropTypes } from 'react';\n\nexport default class ItemSelector extends React.Component {\n\n  static propTypes = {\n    title: PropTypes.string,\n    items: PropTypes.array.isRequired,\n    displayArrow: PropTypes.bool,\n    liClassNames: PropTypes.string,\n    selectedIndex: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    selectedItem: PropTypes.object,\n    onItemSelected: PropTypes.func\n  }\n\n  static defaultProps = {\n    title: '',\n    items: [],\n    displayArrow: true,\n    liClassNames: '',\n    selectedIndex: '',\n    selectedItem: null,\n    onItemSelected: null\n  }\n\n  constructor (props) {\n\n    super(props);\n\n    // manually bind event handlers,\n    // since React ES6 doesn't do this automatically\n    this.onItemClick = this.onItemClick.bind(this);\n    this.onArrowMouseDown = this.onArrowMouseDown.bind(this);\n    this.onArrowMouseUp = this.onArrowMouseUp.bind(this);\n    this.animateScrollPosition = this.animateScrollPosition.bind(this);\n\n  }\n\n  componentWillMount () {\n\n    //\n\n  }\n\n  componentDidMount () {\n\n    this.scrollToSelectedItem();\n\n  }\n\n  componentWillUnmount () {\n\n    //\n\n  }\n\n  componentDidUpdate () {\n\n    this.scrollToSelectedItem();\n\n  }\n\n  onItemClick (event) {\n\n    // Defense.\n    if (!event.currentTarget || !event.currentTarget.dataset) { return; }\n\n    if (this.props.onItemSelected) {\n      this.props.onItemSelected(this.props.items[event.currentTarget.dataset.index], event.currentTarget.dataset.index);\n    }\n\n  }\n\n  onArrowMouseDown (event) {\n\n    let dir;\n    if (event.target.classList.contains('up-arrow')) {\n      dir = -1;\n    } else if (event.target.classList.contains('down-arrow')) {\n      dir = 1;\n    }\n    if (!dir) { return; }\n\n    let itemList = this.refs['item-list'],\n      nextAccelCounter = 16,\n      accelCounter = 0,\n      itemEl = itemList.querySelector('li'),\n      itemMetrics = window.getComputedStyle(itemEl),\n      speed = itemEl.offsetHeight + (itemMetrics ? parseFloat(itemMetrics['margin-bottom'].replace('px', '')) : 0);\n\n    this.arrowMouseUp = false;\n\n    let onArrowMouseHold = function () {\n      if (accelCounter-- <= 1) {\n        this.scrollToPosition(itemList.scrollTop + dir * speed);\n        accelCounter = nextAccelCounter = Math.max(1, Math.floor(nextAccelCounter * 0.75));\n      }\n      \n      if (!this.arrowMouseUp) {\n        window.requestAnimationFrame(onArrowMouseHold);\n      }\n    }.bind(this);\n\n    window.requestAnimationFrame(onArrowMouseHold);\n\n  }\n\n  onArrowMouseUp (event) {\n\n    this.arrowMouseUp = true;\n    \n  }\n\n  scrollToPosition (position) {\n\n    if (typeof this.targetScrollPosition === 'undefined') {\n      // Not currently animating, so start\n      this.targetScrollPosition = position;\n      this.animateScrollPosition();\n    } else {\n      // Already animating; just update target\n      this.targetScrollPosition = position;\n    }\n\n  }\n\n  scrollToSelectedItem () {\n\n    let itemList = this.refs['item-list'],\n      selectedItem = itemList.querySelector('.selected');\n\n    if (selectedItem) {\n      this.scrollToPosition(selectedItem.offsetTop - itemList.offsetHeight);\n    }\n\n  }\n\n  animateScrollPosition () {\n\n    let itemList = this.refs['item-list'],\n      delta;\n\n    if (typeof this.scrollPosition === 'undefined') {\n      this.scrollPosition = itemList.scrollTop;\n    }\n\n    delta = this.targetScrollPosition - this.scrollPosition;\n    \n    if (Math.abs(delta) > 1) {\n      this.scrollPosition += 0.25 * delta;\n      itemList.scrollTop = this.scrollPosition; // scrollTop rounds to the nearest int\n      window.requestAnimationFrame(this.animateScrollPosition);\n    } else {\n      itemList.scrollTop = this.targetScrollPosition;\n      this.targetScrollPosition = undefined;\n      this.scrollPosition = undefined;\n    }\n  }\n\n  getDefaultState () {\n\n    return {};\n\n  }\n\n  render () {\n\n    let isSelected;\n\n    return (\n      <div className='panorama item-selector'>\n        { this.props.title ? <h3>{ this.props.title }</h3> : null }\n        { this.props.displayArrow ? <div className='scroll-arrow up-arrow' onMouseDown={ this.onArrowMouseDown } onMouseUp={ this.onArrowMouseUp } /> : null }\n        <ul ref='item-list'>\n          { this.props.items.map((item, i) => {\n\n            isSelected = \n              this.props.selectedItem && this.props.selectedItem.id == item.id ||  // selectedItem with items as Objects\n              this.props.selectedItem === item ||       // selectedItem with items as Strings\n              this.props.selectedIndex === i;           // selectedIndex\n\n            return (\n              <li\n                className = { 'item ' + this.props.liClassNames + (isSelected ? ' selected' : '') }\n                data-index = { i }\n                key = { i }\n                onClick = { this.onItemClick }\n              >\n                <span>{ item.name.toUpperCase() }</span>\n              </li>\n            );\n\n          }) }\n        </ul>\n        { this.props.displayArrow ? <div className='scroll-arrow down-arrow' onMouseDown={ this.onArrowMouseDown } onMouseUp={ this.onArrowMouseUp } /> : null }\n      </div>\n    );\n\n  }\n\n}\n"]}