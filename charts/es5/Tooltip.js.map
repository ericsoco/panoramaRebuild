{"version":3,"sources":["../es6/Tooltip.js"],"names":[],"mappings":"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","file":"Tooltip.js","sourcesContent":["import d3 from 'd3';\n\nexport const tooltipDefaultOptions = {\n  closeDelay: 100,\n  align: 'top center',\n  offset: [0, -10]\n};\n\nexport default class Tooltip {\n  constructor(element, options) {\n    this._options = {...tooltipDefaultOptions, ...options};\n    this._element = d3.select(element);\n    this.closeTimer = null;\n  }\n\n  get element() {\n    return this._element;\n  }\n\n  set element(val) {\n    this._element = d3.select(val);\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  set options(obj) {\n    this._options = {...this.options, obj};\n  }\n\n  get relativeContainer() {\n    return this._relativeContainer;\n  }\n\n  set relativeContainer(val) {\n    this._relativeContainer = (val.node) ? val.node() : val;\n  }\n\n  unMount() {\n    this._options = {};\n    this._element = null;\n    this._relativeContainer = null;\n    if (this.closeTimer) {\n      clearTimeout(this.closeTimer);\n      this.closeTimer = null;\n    }\n  }\n\n  setPosition(evt) {\n    if (!this.isShowing) return;\n    const position = this.calcPosition(evt);\n    this.element.style('left', (position[0]) + 'px')\n      .style('top', (position[1]) + 'px');\n  }\n\n  // event normalization from: http://www.jacklmoore.com/notes/mouse-position/\n  calcPosition(evt) {\n    let {offset, align} = this.options;\n\n    const alignment = align.split(' ');\n    const offsetWidth = this.element.node().offsetWidth;\n    const offsetHeight = this.element.node().offsetHeight;\n    const target = this.relativeContainer || evt.target || evt.srcElement;\n    const rect = target.getBoundingClientRect();\n    let offsetX = evt.clientX - rect.left;\n    let offsetY = evt.clientY - rect.top;\n\n    // vertical\n    switch(alignment[0]) {\n    case 'top':\n      offsetY -= offsetHeight - offset[1];\n      break;\n\n    case 'bottom':\n    default:\n      offsetY -= offset[1];\n      break;\n    }\n\n    // horizontal\n    switch(alignment[1]) {\n    case 'center':\n      offsetX -= offsetWidth/2 + offset[0];\n      break;\n\n    case 'right':\n      offsetX -= offsetWidth + offset[0];\n      break;\n\n    case 'left':\n    default:\n      offsetX += offset[0];\n      break;\n    }\n\n    return [offsetX, offsetY];\n  }\n\n  setContent(item) {\n    if (typeof this.options.onSetTooltipContent === 'function') {\n      this.options.onSetTooltipContent(this.element, item);\n    } else {\n      this.element.text('');\n    }\n\n    return this;\n  }\n\n  show(evt, item) {\n    if (this.isShowing) return;\n    this.isShowing = true;\n    this.element.classed('active', true);\n    if (evt) this.setPosition(evt);\n    if (item) this.setContent(item);\n\n    return this;\n  }\n\n  hide(immediate) {\n    if (!this.isShowing) return;\n\n    if (this.closeTimer) {\n      clearTimeout(this.closeTimer);\n      this.closeTimer = null;\n    }\n\n    this.isShowing = false;\n\n    if (immediate || this.options.closeDelay < 1) {\n      this.setActiveToFalse();\n    } else {\n      this.closeTimer = setTimeout(() => {\n        if (!this.isShowing) this.setActiveToFalse();\n      }, this.options.closeDelay);\n    }\n\n    return this;\n  }\n\n  setActiveToFalse() {\n    this.closeTimer = null;\n    this.element.classed('active', false);\n  }\n\n  toString() {\n    return 'Tooltip';\n  }\n}"]}