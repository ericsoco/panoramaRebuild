{"version":3,"sources":["../es6/AreaChartD3.js"],"names":[],"mappings":"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","file":"AreaChartD3.js","sourcesContent":["import d3 from 'd3';\nimport { Axis, D3Component } from '../../charts';\n\nexport default class AreaChartD3 extends D3Component {\n\n  willMount() {\n    let {xAccessor, yAccessor, xScale, yScale, interpolate} = this.props;\n    if (this.props.xaxis) {\n      this.setAxis(new Axis(this.props.xaxis, this.props.xScale));\n    }\n\n    if (this.props.yaxis) {\n      this.setAxis(new Axis(this.props.yaxis, this.props.yScale));\n    }\n\n    this.points = [];\n\n    this.areaGenerator = d3.svg.area()\n      .interpolate(interpolate)\n      .x(d => xScale(xAccessor(d)))\n      .y0(d => yScale(0))\n      .y1(d => yScale(yAccessor(d)));\n  }\n\n  onMount() {\n    super.onMount();\n\n    this.baseLayer = this.base.append('g').classed('area-layer', true);\n\n    this._render();\n  }\n\n  getClosestDataIndex(pt) {\n    if (!this.points.length) return null;\n\n    let {data, xAccessor} = this.props;\n\n    this.points.forEach((d) => {\n      d.d = Math.abs(d.x - pt);\n    });\n\n    this.points.sort((a,b) => {return d3.ascending(a.d, b.d);});\n\n    return this.points[0].i;\n  }\n\n  onMouseMoveHandler() {\n    if (!this.hover || !this.tooltip) return;\n\n    const mx = d3.mouse(this.baseLayer.node());\n    const inverted = this.props.xScale.invert(mx[0]);\n    const itemIdx = this.getClosestDataIndex(mx[0]);\n    this.tooltip.setPosition(d3.event);\n\n    if (itemIdx !== null) this.tooltip.setContent(this.props.data[0][itemIdx]);\n\n  }\n\n  preRender() {\n    let {data, xScale, yScale, interpolate, xAccessor, yAccessor} = this.props;\n    xScale.range([0, this.width]);\n    yScale.range([this.height, 0]);\n\n    this.updateAxis(0, xScale, this.props.xaxis);\n    this.updateAxis(1, yScale, this.props.yaxis);\n\n    this.areaGenerator\n      .interpolate(interpolate)\n      .x(d => xScale(xAccessor(d)))\n      .y0(d => yScale(0))\n      .y1(d => yScale(yAccessor(d)));\n\n    this.points = [];\n    if (data.length) {\n      data[0].forEach((d,i) => {\n        const x = xScale(xAccessor(d));\n        this.points.push({x:x, i: i});\n      });\n    }\n  }\n\n  render() {\n    let {data, xAccessor, yAccessor, xScale, yScale, fillColor, fillOpacity} = this.props;\n\n    const area = this.baseLayer.selectAll('path.area').data(data);\n\n    area.exit().remove();\n\n    area.enter()\n      .append('path')\n      .attr('class', 'area');\n\n    area\n      .attr('d', d => this.areaGenerator(d))\n      .style('fill', fillColor)\n      .style('opacity', fillOpacity);\n  }\n\n  postRender() {\n    if (this.props.interactive) {\n      this.baseLayer.selectAll('path.area')\n        .on('mouseover', this.onOver.bind(this))\n        .on('mouseout', this.onOut.bind(this));\n    }\n\n  }\n\n  onOver() {\n    this.hover = true;\n    if (this.tooltip) {\n      this.tooltip.show();\n    }\n  }\n\n  onOut() {\n    this.hover = false;\n    if (this.tooltip) {\n      this.tooltip.hide();\n    }\n  }\n}\n"]}