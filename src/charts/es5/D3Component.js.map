{"version":3,"sources":["../es6/D3Component.js"],"names":[],"mappings":"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","file":"D3Component.js","sourcesContent":["import d3 from 'd3';\nimport Tooltip from './Tooltip';\n\nexport default class D3Component {\n  constructor(props) {\n    this._props = props;\n    this.root = null;\n    this.mounted = false;\n    this.axes = [];\n    this.tooltip = null;\n    this.dispatch = d3.dispatch('mounted', 'updated','mouseOver', 'mouseOut', 'mouseMove', 'click');\n  }\n\n  get selector() {\n    return this._selector;\n  }\n\n  set selector(elm) {\n    this._selector = elm;\n  }\n\n  get props() {\n    return this._props;\n  }\n\n  set props(val) {\n    this._props = val;\n  }\n\n  set tooltipRef(val) {\n    this._tooltipRef = val;\n  }\n\n  get tooltipRef() {\n    return this._tooltipRef;\n  }\n\n  /*----------  Lifecycle methods  ----------*/\n\n  willMount() {\n    // Not doing anything here, but someone else in the\n    // inheritance chain could find it useful\n  }\n\n  onMount() {\n    if (this.mounted) return;\n\n    this.addEvents();\n\n    this.root = d3.select(this.selector);\n    this.svg = this.root.append('svg')\n      .classed('interactive', this.props.interactive);\n\n    if (this.props.interactive && this.props.tooltip) {\n      this.svg.on('mousemove', this.dispatch.mouseMove);\n    }\n\n    // add chart to `this.base`\n    this.base = this.svg.append('g');\n\n    this.updateDimensions();\n\n    this.axes.forEach(axis => axis.onMount(this.base));\n\n    if (this.tooltipRef) {\n      this.tooltip = new Tooltip(this.tooltipRef, this.props.tooltipOptions || {});\n      this.tooltip.relativeContainer = this.svg;\n    }\n\n    this.mounted = true;\n    this.dispatch.mounted();\n  }\n\n  onUpdate() {\n    if (!this.mounted) return;\n\n    this.updateDimensions();\n    this._render();\n    this.dispatch.updated();\n  }\n\n  onUnMount() {\n    this.axes.forEach(axis => axis.onUnMount());\n    this.axes.length = 0;\n    this.removeEvents();\n    this.svg.on('move', null);\n    this.svg.remove();\n    this.root = this.svg = null;\n    this.mounted = false;\n    this.props = null;\n  }\n\n  // TODO: Work on a better\n  // solution, not so rigid\n  addEvents() {\n    this.dispatch.on('mounted', this.onMountedHandler.bind(this));\n    this.dispatch.on('updated', this.onUpdatedHandler.bind(this));\n    this.dispatch.on('mouseOver', this.onMouseOverHandler.bind(this));\n    this.dispatch.on('mouseOut', this.onMouseOutHandler.bind(this));\n    this.dispatch.on('click', this.onClickHandler.bind(this));\n    this.dispatch.on('mouseMove', this.onMouseMoveHandler.bind(this));\n  }\n\n  removeEvents() {\n    this.dispatch.on('mounted', null);\n    this.dispatch.on('updated', null);\n    this.dispatch.on('mouseOver', null);\n    this.dispatch.on('mouseOut', null);\n    this.dispatch.on('mouseMove', null);\n    this.dispatch.on('click', null);\n  }\n\n  onMountedHandler() {\n    if (typeof this.props.onMountHandler === 'function') {\n      this.props.onMountHandler();\n    }\n  }\n\n  onUpdatedHandler() {\n    if (typeof this.props.onUpdatedHandler === 'function') {\n      this.props.onUpdatedHandler();\n    }\n  }\n\n  onMouseOverHandler(d) {\n    if (this.tooltip) {\n      this.tooltip.show(d3.event, d);\n    }\n    if (typeof this.props.onMouseOverHandler === 'function') {\n      this.props.onMouseOverHandler(d);\n    }\n  }\n\n  onMouseOutHandler(d) {\n    if (this.tooltip) {\n      this.tooltip.hide();\n    }\n    if (typeof this.props.onMouseOutHandler === 'function') {\n      this.props.onMouseOutHandler(d);\n    }\n  }\n\n  onMouseMoveHandler() {\n    if (this.tooltip) {\n      this.tooltip.setPosition(d3.event);\n    }\n  }\n\n  onClickHandler(d) {\n    if (typeof this.props.onClickHandler === 'function') {\n      this.props.onClickHandler(d);\n    }\n  }\n\n  setAxis(axis) {\n    if (axis.toString() !== 'Axis') return;\n    this.axes.push(axis);\n  }\n\n  updateAxis(pos, scale, opts) {\n    this.axes[pos].update(scale, opts);\n  }\n\n  _render() {\n    if (!this.props.data) return;\n\n    this.preRender();\n    this.axes.forEach(axis => axis.render());\n    this.render();\n    this.postRender();\n  }\n\n  preRender() {}\n\n  render() {\n    throw new Error('render function should be implemented');\n  }\n\n  postRender() {}\n\n  updateDimensions() {\n    let {width, height, margin} = this.props;\n\n    if (this.width === width && this.height === height) return;\n\n    this.width = width - margin.left - margin.right;\n    this.height = height - margin.top - margin.bottom;\n\n    this.svg\n      .attr('width', width)\n      .attr('height', height);\n\n    this.base\n      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n    this.axes.forEach((axis) => {\n      axis.width = this.width;\n      axis.height = this.height;\n    });\n  }\n}"]}